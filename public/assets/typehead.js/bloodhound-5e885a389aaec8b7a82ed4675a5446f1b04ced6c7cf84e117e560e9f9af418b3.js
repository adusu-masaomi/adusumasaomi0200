!function(e,t){"function"==typeof define&&define.amd?define("bloodhound",["jquery"],function(n){return e.Bloodhound=t(n)}):"object"==typeof exports?module.exports=t(require("jquery")):e.Bloodhound=t(jQuery)}(this,function(e){var t=function(){"use strict";return{isMsie:function(){return!!/(msie|trident)/i.test(navigator.userAgent)&&navigator.userAgent.match(/(msie |rv:)(\d+(.\d+)?)/i)[2]},isBlankString:function(e){return!e||/^\s*$/.test(e)},escapeRegExChars:function(e){return e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")},isString:function(e){return"string"==typeof e},isNumber:function(e){return"number"==typeof e},isArray:e.isArray,isFunction:e.isFunction,isObject:e.isPlainObject,isUndefined:function(e){return"undefined"==typeof e},isElement:function(e){return!(!e||1!==e.nodeType)},isJQuery:function(t){return t instanceof e},toStr:function(e){return t.isUndefined(e)||null===e?"":e+""},bind:e.proxy,each:function(t,n){function r(e,t){return n(t,e)}e.each(t,r)},map:e.map,filter:e.grep,every:function(t,n){var r=!0;return t?(e.each(t,function(e,i){if(!(r=n.call(null,i,e,t)))return!1}),!!r):r},some:function(t,n){var r=!1;return t?(e.each(t,function(e,i){if(r=n.call(null,i,e,t))return!1}),!!r):r},mixin:e.extend,identity:function(e){return e},clone:function(t){return e.extend(!0,{},t)},getIdGenerator:function(){var e=0;return function(){return e++}},templatify:function(t){function n(){return String(t)}return e.isFunction(t)?t:n},defer:function(e){setTimeout(e,0)},debounce:function(e,t,n){var r,i;return function(){var o,a,s=this,u=arguments;return o=function(){r=null,n||(i=e.apply(s,u))},a=n&&!r,clearTimeout(r),r=setTimeout(o,t),a&&(i=e.apply(s,u)),i}},throttle:function(e,t){var n,r,i,o,a,s;return a=0,s=function(){a=new Date,i=null,o=e.apply(n,r)},function(){var u=new Date,l=t-(u-a);return n=this,r=arguments,l<=0?(clearTimeout(i),i=null,a=u,o=e.apply(n,r)):i||(i=setTimeout(s,l)),o}},stringify:function(e){return t.isString(e)?e:JSON.stringify(e)},noop:function(){}}}(),n="0.11.1",r=function(){"use strict";function e(e){return e=t.toStr(e),e?e.split(/\s+/):[]}function n(e){return e=t.toStr(e),e?e.split(/\W+/):[]}function r(e){return function(n){return n=t.isArray(n)?n:[].slice.call(arguments,0),function(r){var i=[];return t.each(n,function(n){i=i.concat(e(t.toStr(r[n])))}),i}}}return{nonword:n,whitespace:e,obj:{nonword:r(n),whitespace:r(e)}}}(),i=function(){"use strict";function n(n){this.maxSize=t.isNumber(n)?n:100,this.reset(),this.maxSize<=0&&(this.set=this.get=e.noop)}function r(){this.head=this.tail=null}function i(e,t){this.key=e,this.val=t,this.prev=this.next=null}return t.mixin(n.prototype,{set:function(e,t){var n,r=this.list.tail;this.size>=this.maxSize&&(this.list.remove(r),delete this.hash[r.key],this.size--),(n=this.hash[e])?(n.val=t,this.list.moveToFront(n)):(n=new i(e,t),this.list.add(n),this.hash[e]=n,this.size++)},get:function(e){var t=this.hash[e];if(t)return this.list.moveToFront(t),t.val},reset:function(){this.size=0,this.hash={},this.list=new r}}),t.mixin(r.prototype,{add:function(e){this.head&&(e.next=this.head,this.head.prev=e),this.head=e,this.tail=this.tail||e},remove:function(e){e.prev?e.prev.next=e.next:this.head=e.next,e.next?e.next.prev=e.prev:this.tail=e.prev},moveToFront:function(e){this.remove(e),this.add(e)}}),n}(),o=function(){"use strict";function n(e,n){this.prefix=["__",e,"__"].join(""),this.ttlKey="__ttl__",this.keyMatcher=new RegExp("^"+t.escapeRegExChars(this.prefix)),this.ls=n||s,!this.ls&&this._noop()}function r(){return(new Date).getTime()}function i(e){return JSON.stringify(t.isUndefined(e)?null:e)}function o(t){return e.parseJSON(t)}function a(e){var t,n,r=[],i=s.length;for(t=0;t<i;t++)(n=s.key(t)).match(e)&&r.push(n.replace(e,""));return r}var s;try{s=window.localStorage,s.setItem("~~~","!"),s.removeItem("~~~")}catch(e){s=null}return t.mixin(n.prototype,{_prefix:function(e){return this.prefix+e},_ttlKey:function(e){return this._prefix(e)+this.ttlKey},_noop:function(){this.get=this.set=this.remove=this.clear=this.isExpired=t.noop},_safeSet:function(e,t){try{this.ls.setItem(e,t)}catch(e){"QuotaExceededError"===e.name&&(this.clear(),this._noop())}},get:function(e){return this.isExpired(e)&&this.remove(e),o(this.ls.getItem(this._prefix(e)))},set:function(e,n,o){return t.isNumber(o)?this._safeSet(this._ttlKey(e),i(r()+o)):this.ls.removeItem(this._ttlKey(e)),this._safeSet(this._prefix(e),i(n))},remove:function(e){return this.ls.removeItem(this._ttlKey(e)),this.ls.removeItem(this._prefix(e)),this},clear:function(){var e,t=a(this.keyMatcher);for(e=t.length;e--;)this.remove(t[e]);return this},isExpired:function(e){var n=o(this.ls.getItem(this._ttlKey(e)));return!!(t.isNumber(n)&&r()>n)}}),n}(),a=function(){"use strict";function n(e){e=e||{},this.cancelled=!1,this.lastReq=null,this._send=e.transport,this._get=e.limiter?e.limiter(this._get):this._get,this._cache=e.cache===!1?new i(0):s}var r=0,o={},a=6,s=new i(10);return n.setMaxPendingRequests=function(e){a=e},n.resetCache=function(){s.reset()},t.mixin(n.prototype,{_fingerprint:function(t){return t=t||{},t.url+t.type+e.param(t.data||{})},_get:function(e,t){function n(e){t(null,e),d._cache.set(u,e)}function i(){t(!0)}function s(){r--,delete o[u],d.onDeckRequestArgs&&(d._get.apply(d,d.onDeckRequestArgs),d.onDeckRequestArgs=null)}var u,l,d=this;u=this._fingerprint(e),this.cancelled||u!==this.lastReq||((l=o[u])?l.done(n).fail(i):r<a?(r++,o[u]=this._send(e).done(n).fail(i).always(s)):this.onDeckRequestArgs=[].slice.call(arguments,0))},get:function(n,r){var i,o;r=r||e.noop,n=t.isString(n)?{url:n}:n||{},o=this._fingerprint(n),this.cancelled=!1,this.lastReq=o,(i=this._cache.get(o))?r(null,i):this._get(n,r)},cancel:function(){this.cancelled=!0}}),n}(),s=window.SearchIndex=function(){"use strict";function n(n){n=n||{},n.datumTokenizer&&n.queryTokenizer||e.error("datumTokenizer and queryTokenizer are both required"),this.identify=n.identify||t.stringify,this.datumTokenizer=n.datumTokenizer,this.queryTokenizer=n.queryTokenizer,this.reset()}function r(e){return e=t.filter(e,function(e){return!!e}),e=t.map(e,function(e){return e.toLowerCase()})}function i(){var e={};return e[u]=[],e[s]={},e}function o(e){for(var t={},n=[],r=0,i=e.length;r<i;r++)t[e[r]]||(t[e[r]]=!0,n.push(e[r]));return n}function a(e,t){var n=0,r=0,i=[];e=e.sort(),t=t.sort();for(var o=e.length,a=t.length;n<o&&r<a;)e[n]<t[r]?n++:e[n]>t[r]?r++:(i.push(e[n]),n++,r++);return i}var s="c",u="i";return t.mixin(n.prototype,{bootstrap:function(e){this.datums=e.datums,this.trie=e.trie},add:function(e){var n=this;e=t.isArray(e)?e:[e],t.each(e,function(e){var o,a;n.datums[o=n.identify(e)]=e,a=r(n.datumTokenizer(e)),t.each(a,function(e){var t,r,a;for(t=n.trie,r=e.split("");a=r.shift();)t=t[s][a]||(t[s][a]=i()),t[u].push(o)})})},get:function(e){var n=this;return t.map(e,function(e){return n.datums[e]})},search:function(e){var n,i,l=this;return n=r(this.queryTokenizer(e)),t.each(n,function(e){var t,n,r,o;if(i&&0===i.length)return!1;for(t=l.trie,n=e.split("");t&&(r=n.shift());)t=t[s][r];return t&&0===n.length?(o=t[u].slice(0),void(i=i?a(i,o):o)):(i=[],!1)}),i?t.map(o(i),function(e){return l.datums[e]}):[]},all:function(){var e=[];for(var t in this.datums)e.push(this.datums[t]);return e},reset:function(){this.datums={},this.trie=i()},serialize:function(){return{datums:this.datums,trie:this.trie}}}),n}(),u=function(){"use strict";function e(e){this.url=e.url,this.ttl=e.ttl,this.cache=e.cache,this.prepare=e.prepare,this.transform=e.transform,this.transport=e.transport,this.thumbprint=e.thumbprint,this.storage=new o(e.cacheKey)}var n;return n={data:"data",protocol:"protocol",thumbprint:"thumbprint"},t.mixin(e.prototype,{_settings:function(){return{url:this.url,type:"GET",dataType:"json"}},store:function(e){this.cache&&(this.storage.set(n.data,e,this.ttl),this.storage.set(n.protocol,location.protocol,this.ttl),this.storage.set(n.thumbprint,this.thumbprint,this.ttl))},fromCache:function(){var e,t={};return this.cache?(t.data=this.storage.get(n.data),t.protocol=this.storage.get(n.protocol),t.thumbprint=this.storage.get(n.thumbprint),e=t.thumbprint!==this.thumbprint||t.protocol!==location.protocol,t.data&&!e?t.data:null):null},fromNetwork:function(e){function t(){e(!0)}function n(t){e(null,i.transform(t))}var r,i=this;e&&(r=this.prepare(this._settings()),this.transport(r).fail(t).done(n))},clear:function(){return this.storage.clear(),this}}),e}(),l=function(){"use strict";function e(e){this.url=e.url,this.prepare=e.prepare,this.transform=e.transform,this.transport=new a({cache:e.cache,limiter:e.limiter,transport:e.transport})}return t.mixin(e.prototype,{_settings:function(){return{url:this.url,type:"GET",dataType:"json"}},get:function(e,t){function n(e,n){t(e?[]:i.transform(n))}var r,i=this;if(t)return e=e||"",r=this.prepare(e,this._settings()),this.transport.get(r,n)},cancelLastRequest:function(){this.transport.cancel()}}),e}(),d=function(){"use strict";function r(r){var i;return r?(i={url:null,ttl:864e5,cache:!0,cacheKey:null,thumbprint:"",prepare:t.identity,transform:t.identity,transport:null},r=t.isString(r)?{url:r}:r,r=t.mixin(i,r),!r.url&&e.error("prefetch requires url to be set"),r.transform=r.filter||r.transform,r.cacheKey=r.cacheKey||r.url,r.thumbprint=n+r.thumbprint,r.transport=r.transport?s(r.transport):e.ajax,r):null}function i(n){var r;if(n)return r={url:null,cache:!0,prepare:null,replace:null,wildcard:null,limiter:null,rateLimitBy:"debounce",rateLimitWait:300,transform:t.identity,transport:null},n=t.isString(n)?{url:n}:n,n=t.mixin(r,n),!n.url&&e.error("remote requires url to be set"),n.transform=n.filter||n.transform,n.prepare=o(n),n.limiter=a(n),n.transport=n.transport?s(n.transport):e.ajax,delete n.replace,delete n.wildcard,delete n.rateLimitBy,delete n.rateLimitWait,n}function o(e){function t(e,t){return t.url=o(t.url,e),t}function n(e,t){return t.url=t.url.replace(a,encodeURIComponent(e)),t}function r(e,t){return t}var i,o,a;return i=e.prepare,o=e.replace,a=e.wildcard,i?i:i=o?t:e.wildcard?n:r}function a(e){function n(e){return function(n){return t.debounce(n,e)}}function r(e){return function(n){return t.throttle(n,e)}}var i,o,a;return i=e.limiter,o=e.rateLimitBy,a=e.rateLimitWait,i||(i=/^throttle$/i.test(o)?r(a):n(a)),i}function s(n){return function(r){function i(e){t.defer(function(){a.resolve(e)})}function o(e){t.defer(function(){a.reject(e)})}var a=e.Deferred();return n(r,i,o),a}}return function(n){var o,a;return o={initialize:!0,identify:t.stringify,datumTokenizer:null,queryTokenizer:null,sufficient:5,sorter:null,local:[],prefetch:null,remote:null},n=t.mixin(o,n||{}),!n.datumTokenizer&&e.error("datumTokenizer is required"),!n.queryTokenizer&&e.error("queryTokenizer is required"),a=n.sorter,n.sorter=a?function(e){return e.sort(a)}:t.identity,n.local=t.isFunction(n.local)?n.local():n.local,n.prefetch=r(n.prefetch),n.remote=i(n.remote),n}}(),c=function(){"use strict";function n(e){e=d(e),this.sorter=e.sorter,this.identify=e.identify,this.sufficient=e.sufficient,this.local=e.local,this.remote=e.remote?new l(e.remote):null,this.prefetch=e.prefetch?new u(e.prefetch):null,this.index=new s({identify:this.identify,datumTokenizer:e.datumTokenizer,queryTokenizer:e.queryTokenizer}),e.initialize!==!1&&this.initialize()}var i;return i=window&&window.Bloodhound,n.noConflict=function(){return window&&(window.Bloodhound=i),n},n.tokenizers=r,t.mixin(n.prototype,{__ttAdapter:function(){function e(e,t,r){return n.search(e,t,r)}function t(e,t){return n.search(e,t)}var n=this;return this.remote?e:t},_loadPrefetch:function(){function t(e,t){return e?n.reject():(i.add(t),i.prefetch.store(i.index.serialize()),void n.resolve())}var n,r,i=this;return n=e.Deferred(),this.prefetch?(r=this.prefetch.fromCache())?(this.index.bootstrap(r),n.resolve()):this.prefetch.fromNetwork(t):n.resolve(),n.promise()},_initialize:function(){function e(){t.add(t.local)}var t=this;return this.clear(),(this.initPromise=this._loadPrefetch()).done(e),this.initPromise},initialize:function(e){return!this.initPromise||e?this._initialize():this.initPromise},add:function(e){return this.index.add(e),this},get:function(e){return e=t.isArray(e)?e:[].slice.call(arguments),this.index.get(e)},search:function(e,n,r){function i(e){var n=[];t.each(e,function(e){!t.some(o,function(t){return a.identify(e)===a.identify(t)})&&n.push(e)}),r&&r(n)}var o,a=this;return o=this.sorter(this.index.search(e)),n(this.remote?o.slice():o),this.remote&&o.length<this.sufficient?this.remote.get(e,i):this.remote&&this.remote.cancelLastRequest(),this},all:function(){return this.index.all()},clear:function(){return this.index.reset(),this},clearPrefetchCache:function(){return this.prefetch&&this.prefetch.clear(),this},clearRemoteCache:function(){return a.resetCache(),this},ttAdapter:function(){return this.__ttAdapter()}}),n}();return c});